#include <string>
#include <iostream>
#include <dirent.h>
using namespace std;

int main()
{
 OPENFILENAME ofn;     // общая структура диалогового окна
            wchar_t szFile[260];      // буфер для имени файла
            HWND hwnd;              // окно владельца
            HANDLE hf;              // дескриптор файла

           // Инициализировать OPENFILENAME
            ZeroMemory(&ofn, sizeof(ofn));
            ofn.lStructSize = sizeof(ofn);
            ofn.hwndOwner = NULL;
            ofn.lpstrFile = szFile;
            // Устанавливаем lpstrFile [0] в '\ 0', чтобы GetOpenFileName не
            // использовать содержимое szFile для инициализации.
            ofn.lpstrFile[0] = '\0';
            ofn.nMaxFile = sizeof(szFile);
            ofn.lpstrFilter = L"Excel files 2003(*.xls)\0*.xls\0Excel files 2007(*.xlsx)\0*.xlsx\0";
            ofn.nFilterIndex = 1;
            ofn.lpstrFileTitle = NULL;
            ofn.nMaxFileTitle = 0;
            ofn.lpstrInitialDir = NULL;
            ofn.Flags = OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST;

           // Отображение диалогового окна "Открыть".

            if (GetOpenFileName(&ofn)==TRUE)
                          {


               }

}
